
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>galaxy_dive.plot_data.plotting &#8212; galaxy-dive 0.8.1 documentation</title>
    <link rel="stylesheet" href="../../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
   
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for galaxy_dive.plot_data.plotting</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="sd">&#39;&#39;&#39;General purpose plotting tools.</span>

<span class="sd">@author: Zach Hafen</span>
<span class="sd">@contact: zachary.h.hafen@gmail.com</span>
<span class="sd">@status: Development</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">errno</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">plt_colors</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="k">import</span> <span class="n">make_axes_locatable</span>

<span class="kn">import</span> <span class="nn">galaxy_dive.utils.data_operations</span> <span class="k">as</span> <span class="nn">data_ops</span>
<span class="kn">import</span> <span class="nn">galaxy_dive.utils.astro</span> <span class="k">as</span> <span class="nn">astro_utils</span>

<span class="c1">########################################################################</span>
<span class="c1">########################################################################</span>

<div class="viewcode-block" id="box_plot"><a class="viewcode-back" href="../../../galaxy_dive.plot_data.plotting.html#galaxy_dive.plot_data.plotting.box_plot">[docs]</a><span class="k">def</span> <span class="nf">box_plot</span><span class="p">(</span>
    <span class="n">x_datas</span><span class="p">,</span>
    <span class="n">y_datas</span><span class="p">,</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
    <span class="n">x_scale</span> <span class="o">=</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span>
    <span class="n">y_scale</span> <span class="o">=</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span>
    <span class="n">y_floor</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">box_upper_limit</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">box_lower_limit</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">box_zorder</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
    <span class="n">blank_zorder</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span>
    <span class="n">line_zorder</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="n">zorder_offset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">plot_boxes</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">skip_single_points</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span>
<span class="p">):</span>

    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="n">means</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span> <span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;y&#39;</span> <span class="p">:</span> <span class="p">[],</span>
    <span class="p">}</span>
    <span class="n">errs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span> <span class="p">:</span> <span class="p">[],</span>
        <span class="s1">&#39;y&#39;</span> <span class="p">:</span> <span class="p">[],</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">x_datas</span><span class="p">,</span> <span class="n">y_datas</span> <span class="p">):</span>

        <span class="k">if</span> <span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="n">x_data</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="p">)</span> <span class="ow">and</span> <span class="n">skip_single_points</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># Make copies so we don&#39;t modify the data</span>
        <span class="n">x_data</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span> <span class="n">x_data</span> <span class="p">)</span>
        <span class="n">y_data</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span> <span class="n">y_data</span> <span class="p">)</span>

        <span class="c1"># Apply a floor</span>
        <span class="n">y_data</span><span class="p">[</span><span class="n">y_data</span><span class="o">&lt;</span><span class="n">y_floor</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_floor</span>

        <span class="c1"># Put in logspace</span>
        <span class="k">if</span> <span class="n">x_scale</span> <span class="o">==</span> <span class="s1">&#39;log&#39;</span><span class="p">:</span>
            <span class="n">x_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span> <span class="n">x_data</span> <span class="p">)</span>
        <span class="k">if</span> <span class="n">y_scale</span> <span class="o">==</span> <span class="s1">&#39;log&#39;</span><span class="p">:</span>
            <span class="n">y_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span> <span class="n">y_data</span> <span class="p">)</span>

        <span class="n">x_mean</span> <span class="o">=</span> <span class="n">x_data</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">y_mean</span> <span class="o">=</span> <span class="n">y_data</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

        <span class="n">x_err</span> <span class="o">=</span> <span class="n">x_data</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
        <span class="n">y_err</span> <span class="o">=</span> <span class="n">y_data</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

        <span class="c1"># Get the negative and positive errs</span>
        <span class="k">if</span> <span class="n">x_scale</span> <span class="o">==</span> <span class="s1">&#39;log&#39;</span><span class="p">:</span>
            <span class="n">x_err_neg</span><span class="p">,</span> <span class="n">x_err_pos</span> <span class="o">=</span> <span class="n">errs_from_log_errs</span><span class="p">(</span>
                <span class="n">x_mean</span><span class="p">,</span>
                <span class="n">x_err</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">x_scale</span> <span class="o">==</span> <span class="s1">&#39;linear&#39;</span><span class="p">:</span>
            <span class="n">x_err_neg</span> <span class="o">=</span> <span class="n">x_err</span>
            <span class="n">x_err_pos</span> <span class="o">=</span> <span class="n">x_err</span>
        <span class="k">if</span> <span class="n">y_scale</span> <span class="o">==</span> <span class="s1">&#39;log&#39;</span><span class="p">:</span>
            <span class="n">y_err_neg</span><span class="p">,</span> <span class="n">y_err_pos</span> <span class="o">=</span> <span class="n">errs_from_log_errs</span><span class="p">(</span>
                <span class="n">y_mean</span><span class="p">,</span>
                <span class="n">y_err</span><span class="p">,</span>
                <span class="n">upper_limit</span> <span class="o">=</span> <span class="n">box_upper_limit</span><span class="p">,</span>
                <span class="n">lower_limit</span> <span class="o">=</span> <span class="n">box_lower_limit</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">y_scale</span> <span class="o">==</span> <span class="s1">&#39;linear&#39;</span><span class="p">:</span>
            <span class="n">y_err_neg</span> <span class="o">=</span> <span class="n">y_err</span>
            <span class="n">y_err_pos</span> <span class="o">=</span> <span class="n">y_err</span>

        <span class="k">if</span> <span class="n">x_scale</span> <span class="o">==</span> <span class="s1">&#39;log&#39;</span><span class="p">:</span>
            <span class="n">x_mean</span> <span class="o">=</span> <span class="mf">10.</span><span class="o">**</span><span class="n">x_mean</span>
        <span class="k">if</span> <span class="n">y_scale</span> <span class="o">==</span> <span class="s1">&#39;log&#39;</span><span class="p">:</span>
            <span class="n">y_mean</span> <span class="o">=</span> <span class="mf">10.</span><span class="o">**</span><span class="n">y_mean</span>

        <span class="c1"># Store for plotting</span>
        <span class="n">means</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">x_mean</span> <span class="p">)</span>
        <span class="n">means</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">y_mean</span> <span class="p">)</span>
        <span class="n">errs</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">x_mean</span> <span class="p">)</span>
        <span class="n">errs</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">x_mean</span> <span class="p">)</span>

        <span class="n">left</span> <span class="o">=</span> <span class="n">x_mean</span> <span class="o">-</span> <span class="n">x_err_neg</span>
        <span class="n">bottom</span> <span class="o">=</span> <span class="n">y_mean</span> <span class="o">-</span> <span class="n">y_err_neg</span>

        <span class="n">width</span> <span class="o">=</span> <span class="n">x_err_neg</span> <span class="o">+</span> <span class="n">x_err_pos</span>
        <span class="n">height</span> <span class="o">=</span> <span class="n">y_err_neg</span> <span class="o">+</span> <span class="n">y_err_pos</span>

        <span class="k">if</span> <span class="n">plot_boxes</span><span class="p">:</span>
            <span class="c1"># Rectangle itself</span>
            <span class="n">rect</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span>
                <span class="p">(</span><span class="n">left</span><span class="p">,</span><span class="n">bottom</span><span class="p">),</span>
                <span class="n">width</span><span class="p">,</span>
                <span class="n">height</span><span class="p">,</span>
                <span class="n">fill</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">edgecolor</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span>
                <span class="n">linewidth</span> <span class="o">=</span> <span class="n">linewidth</span><span class="p">,</span>
                <span class="n">zorder</span> <span class="o">=</span> <span class="n">box_zorder</span> <span class="o">-</span> <span class="n">zorder_offset</span><span class="p">,</span>
            <span class="p">)</span>                
            <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span> <span class="n">rect</span> <span class="p">)</span>
            
            <span class="c1"># Blank rectangles to clean things up</span>
            <span class="n">rect</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">patches</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">(</span>
                <span class="p">(</span><span class="n">left</span><span class="p">,</span><span class="n">bottom</span><span class="p">),</span>
                <span class="n">width</span><span class="p">,</span>
                <span class="n">height</span><span class="p">,</span>
                <span class="n">facecolor</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span>
                <span class="n">edgecolor</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span>
                <span class="n">linewidth</span> <span class="o">=</span> <span class="n">linewidth</span><span class="p">,</span>
                <span class="n">zorder</span> <span class="o">=</span> <span class="n">blank_zorder</span> <span class="o">-</span> <span class="n">zorder_offset</span><span class="p">,</span>
            <span class="p">)</span>                
            <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span> <span class="n">rect</span> <span class="p">)</span>

    <span class="n">sorted_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span> <span class="n">means</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="p">)</span>

    <span class="c1"># Plot everything else</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="n">means</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="p">)[</span><span class="n">sorted_inds</span><span class="p">],</span>
        <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="n">means</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="p">)[</span><span class="n">sorted_inds</span><span class="p">],</span>
        <span class="n">linewidth</span> <span class="o">=</span> <span class="n">linewidth</span><span class="p">,</span>
        <span class="n">color</span> <span class="o">=</span> <span class="n">color</span><span class="p">,</span>
        <span class="n">zorder</span> <span class="o">=</span> <span class="n">line_zorder</span> <span class="o">-</span> <span class="n">zorder_offset</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Set scale</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span> <span class="n">x_scale</span> <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span> <span class="n">y_scale</span> <span class="p">)</span></div>

<span class="c1">########################################################################</span>

<div class="viewcode-block" id="errs_from_log_errs"><a class="viewcode-back" href="../../../galaxy_dive.plot_data.plotting.html#galaxy_dive.plot_data.plotting.errs_from_log_errs">[docs]</a><span class="k">def</span> <span class="nf">errs_from_log_errs</span><span class="p">(</span> <span class="n">log_mean</span><span class="p">,</span> <span class="n">log_err</span><span class="p">,</span> <span class="n">upper_limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lower_limit</span><span class="o">=</span><span class="kc">None</span> <span class="p">):</span>
    
    <span class="n">err_positive</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">10.</span><span class="o">**</span><span class="n">log_mean</span> <span class="p">)</span> <span class="o">*</span> \
        <span class="p">(</span> <span class="mf">10.</span><span class="o">**</span><span class="n">log_err</span> <span class="o">-</span> <span class="mf">1.</span> <span class="p">)</span>
    <span class="n">err_negative</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">*</span><span class="p">(</span> <span class="mf">10.</span><span class="o">**</span><span class="n">log_mean</span> <span class="p">)</span> <span class="o">*</span> \
        <span class="p">(</span> <span class="mf">10.</span><span class="o">**-</span><span class="n">log_err</span> <span class="o">-</span> <span class="mf">1.</span> <span class="p">)</span>
        
    <span class="k">if</span> <span class="n">upper_limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">exceeds_limit</span> <span class="o">=</span> <span class="mf">10.</span><span class="o">**</span><span class="n">log_mean</span> <span class="o">+</span> <span class="n">err_positive</span> <span class="o">&gt;</span> <span class="n">upper_limit</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">err_positive</span><span class="p">[</span><span class="n">exceeds_limit</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="n">upper_limit</span> <span class="o">-</span> <span class="mf">10.</span><span class="o">**</span><span class="n">log_mean</span> <span class="p">)[</span><span class="n">exceeds_limit</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">err_positive</span> <span class="o">=</span> <span class="p">(</span> <span class="n">upper_limit</span> <span class="o">-</span> <span class="mf">10.</span><span class="o">**</span><span class="n">log_mean</span> <span class="p">)</span>

    <span class="k">if</span> <span class="n">lower_limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">exceeds_limit</span> <span class="o">=</span> <span class="mf">10.</span><span class="o">**</span><span class="n">log_mean</span> <span class="o">-</span> <span class="n">err_negative</span> <span class="o">&lt;</span> <span class="n">lower_limit</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">err_negative</span><span class="p">[</span><span class="n">exceeds_limit</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">10.</span><span class="o">**</span><span class="n">log_mean</span> <span class="o">-</span> <span class="n">lower_limit</span> <span class="p">)[</span><span class="n">exceeds_limit</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">err_negative</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">10.</span><span class="o">**</span><span class="n">log_mean</span> <span class="o">-</span> <span class="n">lower_limit</span> <span class="p">)</span>
        
    <span class="k">return</span> <span class="n">err_negative</span><span class="p">,</span> <span class="n">err_positive</span></div>

<span class="c1">########################################################################</span>

<div class="viewcode-block" id="add_redshift_to_axis"><a class="viewcode-back" href="../../../galaxy_dive.plot_data.plotting.html#galaxy_dive.plot_data.plotting.add_redshift_to_axis">[docs]</a><span class="k">def</span> <span class="nf">add_redshift_to_axis</span><span class="p">(</span>
        <span class="n">ax</span><span class="p">,</span>
        <span class="n">hubble</span><span class="p">,</span>
        <span class="n">omega_matter</span><span class="p">,</span>
        <span class="n">tick_redshifts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Add redshift labels to the top axis of plot that has age of the universe</span>
<span class="sd">    on the bottom axis.</span>

<span class="sd">    Args:</span>
<span class="sd">        ax (axis object): Original axis</span>

<span class="sd">        hubble (float): Hubble parameter, used for calculating the age.</span>

<span class="sd">        omega_matter (float): Cosmological param used for calcing the age.</span>

<span class="sd">        tick_redshifts (array-like): Redshifts to plot ticks at.</span>
<span class="sd">    </span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">tick_times</span> <span class="o">=</span> <span class="n">astro_utils</span><span class="o">.</span><span class="n">age_of_universe</span><span class="p">(</span>
        <span class="n">tick_redshifts</span><span class="p">,</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">hubble</span><span class="p">,</span>
        <span class="n">omega_matter</span> <span class="o">=</span> <span class="n">omega_matter</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Make sure we aren&#39;t trying to plot ticks that would go out of bounds,</span>
    <span class="c1"># because that breaks things</span>
    <span class="n">ax2_ticks</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">ax2_tick_labels</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">x_range</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">ax2_tick</span><span class="p">,</span> <span class="n">ax2_tick_label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span> <span class="n">tick_times</span><span class="p">,</span> <span class="n">tick_redshifts</span> <span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span> <span class="n">ax2_tick</span> <span class="o">&gt;</span> <span class="n">x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="n">ax2_tick</span> <span class="o">&lt;</span> <span class="n">x_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">):</span>
            <span class="n">ax2_ticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">ax2_tick</span> <span class="p">)</span>
            <span class="n">ax2_tick_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">ax2_tick_label</span> <span class="p">)</span>

    <span class="c1"># Add a second axis for plotting</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span> <span class="n">x_range</span> <span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span> <span class="n">ax2_ticks</span> <span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span> <span class="n">ax2_tick_labels</span> <span class="p">)</span>

    <span class="k">return</span> <span class="n">ax2</span></div>
        
<span class="c1">########################################################################</span>

<div class="viewcode-block" id="make_movie"><a class="viewcode-back" href="../../../galaxy_dive.plot_data.plotting.html#galaxy_dive.plot_data.plotting.make_movie">[docs]</a><span class="k">def</span> <span class="nf">make_movie</span><span class="p">(</span> <span class="n">img_dir</span><span class="p">,</span> <span class="n">file_pattern</span><span class="p">,</span> <span class="n">movie_save_file</span><span class="p">,</span> <span class="n">quality</span><span class="o">=</span><span class="mi">1</span> <span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Make a movie using ffmpeg.</span>

<span class="sd">    Args:</span>
<span class="sd">        img_dir (str) : Directory containing images to stitch together.</span>
<span class="sd">        file_pattern (str) : Pattern for the images.</span>
<span class="sd">        movie_save_file (str) : What to save the movie as. Typically .mp4 or .avi</span>
<span class="sd">        quality (int) : What quality to use for making the movie (1-31). Default is 1, which is highest quality.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">prev_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span> <span class="n">img_dir</span> <span class="p">)</span>

    <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">(</span> <span class="p">[</span> <span class="s2">&quot;ffmpeg&quot;</span><span class="p">,</span> <span class="s2">&quot;-pattern_type&quot;</span><span class="p">,</span> <span class="s2">&quot;glob&quot;</span><span class="p">,</span> <span class="s2">&quot;-i&quot;</span><span class="p">,</span> <span class="n">file_pattern</span><span class="p">,</span> <span class="s2">&quot;-q:v&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span> <span class="n">quality</span> <span class="p">),</span> <span class="n">movie_save_file</span><span class="p">,</span> <span class="p">])</span>

    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span> <span class="n">prev_dir</span> <span class="p">)</span></div>

<span class="c1">########################################################################</span>


<div class="viewcode-block" id="add_colorbar"><a class="viewcode-back" href="../../../galaxy_dive.plot_data.plotting.html#galaxy_dive.plot_data.plotting.add_colorbar">[docs]</a><span class="k">def</span> <span class="nf">add_colorbar</span><span class="p">(</span> <span class="n">fig_or_ax</span><span class="p">,</span> <span class="n">color_object</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;fig&#39;</span><span class="p">,</span> <span class="n">ax_location</span><span class="o">=</span><span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="o">**</span><span class="n">kw_args</span> <span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Add a colorbar to a figure(fig) according to an object on the figure(color_object). Added to the right side of the figure.</span>
<span class="sd">    Or add a colorbar to the right of an axis.</span>

<span class="sd">    Args:</span>
<span class="sd">        fig_or_ax (figure or axis object): The object to add the colorbar to.</span>
<span class="sd">        color_object (object): The object providing the colorscheme, i.e. what you want the colorbar to provide a map for.</span>
<span class="sd">        method (str): If &#39;fig&#39;, add to the right of the figure. If &#39;ax&#39;, add to the right of the axis.</span>
<span class="sd">        ax_location (list): If adding to a figure, this is where and how large the axis will be.</span>
<span class="sd">        **kw_args will be passed to colorbar()</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;fig&#39;</span><span class="p">:</span>

        <span class="n">cax</span> <span class="o">=</span> <span class="n">fig_or_ax</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">ax_location</span><span class="p">)</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig_or_ax</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">color_object</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_args</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;ax&#39;</span><span class="p">:</span>

        <span class="c1"># Create divider for existing axes instance</span>
        <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">fig_or_ax</span><span class="p">)</span>

        <span class="c1"># Append axes to the right of ax, with 5% width of ax</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;5%&#39;</span><span class="p">)</span>

        <span class="c1"># Create colorbar in the appended axes</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">color_object</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_args</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cbar</span></div>

<span class="c1">########################################################################</span>

<span class="c1"># Functions for switching between a single index and a pair of indexes in the same way that add_subplot maps single subplots.</span>


<div class="viewcode-block" id="custom_sequential_colormap"><a class="viewcode-back" href="../../../galaxy_dive.plot_data.plotting.html#galaxy_dive.plot_data.plotting.custom_sequential_colormap">[docs]</a><span class="k">def</span> <span class="nf">custom_sequential_colormap</span><span class="p">(</span>
    <span class="n">color1</span><span class="p">,</span>
    <span class="n">color2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">cmap_name</span> <span class="o">=</span> <span class="s1">&#39;custom&#39;</span><span class="p">,</span>
    <span class="n">n_bins</span> <span class="o">=</span> <span class="mi">256</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Create a custom sequential colormap using one to two colors</span>

<span class="sd">    Args:</span>
<span class="sd">        color1 (color identifier, e.g. hex or RGB tuple) :</span>
<span class="sd">            One of the two colors used. The colormap transtions from color1</span>
<span class="sd">            to color2 on a gradient.</span>

<span class="sd">        color2 (color identifier, e.g. hex or RGB tuple) :</span>
<span class="sd">            One of the two colors used. The colormap transtions from color1</span>
<span class="sd">            to color2 on a gradient.</span>

<span class="sd">        cmap_name (str) :</span>
<span class="sd">            What to call the colormap.</span>

<span class="sd">        n_bins (int) :</span>
<span class="sd">            Number of bins to divide the colormap into.</span>

<span class="sd">    Returns:</span>
<span class="sd">        cmap (colormap instance) :</span>
<span class="sd">            Resulting colormap.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span> <span class="n">color1</span><span class="p">,</span> <span class="n">color2</span> <span class="p">]</span>

    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt_colors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span>
        <span class="n">cmap_name</span><span class="p">,</span>
        <span class="n">colors</span><span class="p">,</span>
        <span class="n">N</span> <span class="o">=</span> <span class="n">n_bins</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">cmap</span></div>


<div class="viewcode-block" id="reading_indexes"><a class="viewcode-back" href="../../../galaxy_dive.plot_data.plotting.html#galaxy_dive.plot_data.plotting.reading_indexes">[docs]</a><span class="k">def</span> <span class="nf">reading_indexes</span><span class="p">(</span> <span class="n">index</span><span class="p">,</span> <span class="n">num_cols</span> <span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Switch to multiple indexes for a plot.</span>

<span class="sd">    Args:</span>
<span class="sd">        index (int): An index that can be used to access a subplot in the same way add_subplot() accesses subplots.</span>
<span class="sd">        num_cols (int): Number of columns in the figure.</span>

<span class="sd">    Returns:</span>
<span class="sd">        horizontal_index (int): Horizontal index of the plot.</span>
<span class="sd">        vertical_index (int): Vertical index of the plot.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">horizontal_index</span> <span class="o">=</span> <span class="n">index</span> <span class="o">%</span> <span class="n">num_cols</span>
    <span class="n">vertical_index</span> <span class="o">=</span> <span class="n">index</span> <span class="o">/</span> <span class="n">num_cols</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">horizontal_index</span><span class="p">,</span> <span class="n">vertical_index</span><span class="p">)</span></div>


<div class="viewcode-block" id="single_index"><a class="viewcode-back" href="../../../galaxy_dive.plot_data.plotting.html#galaxy_dive.plot_data.plotting.single_index">[docs]</a><span class="k">def</span> <span class="nf">single_index</span><span class="p">(</span> <span class="n">horizontal_index</span><span class="p">,</span> <span class="n">vertical_index</span><span class="p">,</span> <span class="n">num_cols</span> <span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Switch to a single index for a plot.</span>

<span class="sd">    Args:</span>
<span class="sd">        horizontal_index (int): Horizontal index of the plot.</span>
<span class="sd">        vertical_index (int): Vertical index of the plot.</span>
<span class="sd">        num_cols (int): Number of columns in the figure.</span>

<span class="sd">    Returns:</span>
<span class="sd">        index (int): An index that can be used to access a subplot in the same way add_subplot() accesses subplots.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">return</span> <span class="n">vertical_index</span> <span class="o">*</span> <span class="n">num_cols</span> <span class="o">+</span> <span class="n">horizontal_index</span></div>

<span class="c1">########################################################################</span>


<div class="viewcode-block" id="calc_num_rows"><a class="viewcode-back" href="../../../galaxy_dive.plot_data.plotting.html#galaxy_dive.plot_data.plotting.calc_num_rows">[docs]</a><span class="k">def</span> <span class="nf">calc_num_rows</span><span class="p">(</span> <span class="n">num_plots</span><span class="p">,</span> <span class="n">num_cols</span> <span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Find the number of plots given the number of plots and the number of columns.</span>

<span class="sd">    Args:</span>
<span class="sd">        num_plots (int): Number of subplots.</span>
<span class="sd">        num_cols (int): Number of columns in the figure.</span>

<span class="sd">    Returns:</span>
<span class="sd">        num_rows (int): Number of rows in the figure.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">h_index_end</span><span class="p">,</span> <span class="n">v_index_end</span> <span class="o">=</span> <span class="n">reading_indexes</span><span class="p">(</span><span class="n">num_plots</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_cols</span><span class="p">)</span>
    <span class="n">num_rows</span> <span class="o">=</span> <span class="n">v_index_end</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">num_rows</span></div>

<span class="c1">########################################################################</span>


<div class="viewcode-block" id="remove_all_space"><a class="viewcode-back" href="../../../galaxy_dive.plot_data.plotting.html#galaxy_dive.plot_data.plotting.remove_all_space">[docs]</a><span class="k">def</span> <span class="nf">remove_all_space</span><span class="p">(</span> <span class="n">figure</span><span class="p">,</span> <span class="n">num_rows</span><span class="p">,</span> <span class="n">num_cols</span><span class="p">,</span> <span class="n">num_plots</span> <span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Removes any space between subplots for the given figure instance.</span>

<span class="sd">    Args:</span>
<span class="sd">        figure (figure object): The figure to alter.</span>
<span class="sd">        num_rows (int): Number of rows in the figure.</span>
<span class="sd">        num_cols (int): Number of columns in the figure.</span>
<span class="sd">        num_plots (int): Number of subplots.</span>

<span class="sd">    Modifies:</span>
<span class="sd">        figure (figure object): Alters the spacing.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># Remove any space between the plots.</span>
    <span class="n">figure</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_plots</span><span class="p">):</span>

        <span class="c1"># Get the subplot to plot it on.</span>
        <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">reading_indexes</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">num_cols</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">num_rows</span><span class="p">,</span> <span class="n">num_cols</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Get rid of x tick marks for middle graphs</span>
        <span class="k">if</span> <span class="n">single_index</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">num_cols</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">num_plots</span><span class="p">:</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Get rid of y tick marks for middle graphs</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Get rid of tick labels that overlap with each other</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">num_cols</span> <span class="o">-</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">==</span> <span class="n">num_rows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Get rid of x-tick labels that overlap with the other plots.</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">num_rows</span><span class="p">:</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

        <span class="c1"># Avoid overlapping x- and y-tick marks of the same subplot.</span>

<span class="c1">########################################################################</span>


<div class="viewcode-block" id="save_fig"><a class="viewcode-back" href="../../../galaxy_dive.plot_data.plotting.html#galaxy_dive.plot_data.plotting.save_fig">[docs]</a><span class="k">def</span> <span class="nf">save_fig</span><span class="p">(</span> <span class="n">out_dir</span><span class="p">,</span> <span class="n">save_file</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">save_args</span> <span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Save a figure using a pretty frequent combination of details.</span>

<span class="sd">    Args:</span>
<span class="sd">        out_dir (str): Output directory.</span>
<span class="sd">        save_file (str): Save file name.</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        fig : Figure or axis.</span>
<span class="sd">        resolution : What resolution to save the figure as. Defaults to 3600 pixels on the shortest side.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># Make sure the output directory exists</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">out_dir</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>  <span class="c1"># Python &gt;2.5</span>
        <span class="k">if</span> <span class="n">exc</span><span class="o">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">errno</span><span class="o">.</span><span class="n">EEXIST</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">out_dir</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span>
    
    <span class="k">if</span> <span class="n">resolution</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
        <span class="n">figsize</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()</span> <span class="p">)</span>
        <span class="n">dpi</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="mf">3600.</span><span class="o">/</span><span class="n">figsize</span> <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dpi</span> <span class="o">=</span> <span class="n">resolution</span>

    <span class="n">default_save_args</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dpi&#39;</span><span class="p">:</span> <span class="n">dpi</span><span class="p">,</span> <span class="s1">&#39;bbox_inches&#39;</span><span class="p">:</span> <span class="s1">&#39;tight&#39;</span><span class="p">}</span>
    <span class="n">used_save_args</span> <span class="o">=</span> <span class="n">data_ops</span><span class="o">.</span><span class="n">merge_dict</span><span class="p">(</span> <span class="n">save_args</span><span class="p">,</span> <span class="n">default_save_args</span><span class="p">)</span>

    <span class="c1"># Save the figure.</span>
    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">save_file</span><span class="p">),</span> <span class="o">**</span><span class="n">used_save_args</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">save_file</span><span class="p">),</span> <span class="o">**</span><span class="n">used_save_args</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;File saved at </span><span class="si">%s</span><span class="s1">/</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">out_dir</span><span class="p">,</span> <span class="n">save_file</span><span class="p">))</span></div>

<span class="c1">########################################################################</span>


<div class="viewcode-block" id="fill_between_steps"><a class="viewcode-back" href="../../../galaxy_dive.plot_data.plotting.html#galaxy_dive.plot_data.plotting.fill_between_steps">[docs]</a><span class="k">def</span> <span class="nf">fill_between_steps</span><span class="p">(</span> <span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">step_where</span><span class="o">=</span><span class="s1">&#39;pre&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span> <span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Fill between for a step plot.</span>

<span class="sd">        Args:</span>
<span class="sd">            ax (Axes) The axes to draw to</span>
<span class="sd">            x (array-like): Array/vector of index values.</span>
<span class="sd">            y1 (array-like or float): Array/vector of values to be filled under.</span>
<span class="sd">            y2 (array-Like or float, optional): Array/vector or bottom values for filled area. Default is 0.</span>
<span class="sd">            step_where ({&#39;pre&#39;, &#39;post&#39;, &#39;mid&#39;}): where the step happens, same meanings as for `step`</span>
<span class="sd">            **kwargs will be passed to the matplotlib fill_between() function.</span>

<span class="sd">        Returns</span>
<span class="sd">            ret (PolyCollection): The added artist</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">step_where</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;pre&#39;</span><span class="p">,</span> <span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="s1">&#39;mid&#39;</span><span class="p">}:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;where must be one of {{&#39;pre&#39;, &#39;post&#39;, &#39;mid&#39;}} &quot;</span>
                    <span class="s2">&quot;You passed in </span><span class="si">{wh}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wh</span><span class="o">=</span><span class="n">step_where</span><span class="p">))</span>

        <span class="c1"># make sure y values are up-converted to arrays</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">y1</span><span class="p">):</span>
                <span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">y1</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">y2</span><span class="p">):</span>
                <span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">y2</span>

        <span class="c1"># temporary array for up-converting the values to step corners</span>
        <span class="c1"># 3 x 2N - 1 array</span>

        <span class="n">vertices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">))</span>

        <span class="c1"># this logic is lifted from lines.py</span>
        <span class="c1"># this should probably be centralized someplace</span>
        <span class="k">if</span> <span class="n">step_where</span> <span class="o">==</span> <span class="s1">&#39;pre&#39;</span><span class="p">:</span>
                <span class="n">steps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
                <span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:],</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:]</span>

        <span class="k">elif</span> <span class="n">step_where</span> <span class="o">==</span> <span class="s1">&#39;post&#39;</span><span class="p">:</span>
                <span class="n">steps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
                <span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:],</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:]</span>
                <span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:],</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">step_where</span> <span class="o">==</span> <span class="s1">&#39;mid&#39;</span><span class="p">:</span>
                <span class="n">steps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>
                <span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:])</span>
                <span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:])</span>
                <span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
                <span class="n">steps</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">0</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span> <span class="n">steps</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:],</span> <span class="n">vertices</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;should never hit end of if-elif block for validated input&quot;</span><span class="p">)</span>

        <span class="c1"># un-pack</span>
        <span class="n">xx</span><span class="p">,</span> <span class="n">yy1</span><span class="p">,</span> <span class="n">yy2</span> <span class="o">=</span> <span class="n">steps</span>

        <span class="c1"># now to the plotting part:</span>
        <span class="k">return</span> <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy1</span><span class="p">,</span> <span class="n">y2</span><span class="o">=</span><span class="n">yy2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../index.html">Documentation overview</a><ul>
  <li><a href="../../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Zachary Hafen.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
    </div>

    

    
  </body>
</html>